(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{222:function(n,t,s){"use strict";s.r(t);var e=s(0),i=Object(e.a)({},function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("p",[n._v("[转]"),s("a",{attrs:{href:"https://blog.csdn.net/q291611265/article/details/46392453",title:"kaptcha在Linux中ImageIO生成图片中文乱码",target:"_blank",rel:"noopener noreferrer"}},[n._v("kaptcha在Linux中ImageIO生成图片中文乱码"),s("OutboundLink")],1)]),n._v(" "),s("p",[n._v("在我的工具网站中的在线文字生成图片功能，开发是在Windows系统中进行的，在Windows中一切良好，中英文都能很好的展示，但是在我将程序部署到Linux中后，却出现生成的图片中中文全部乱码(显示成一个个的方框)。")]),n._v(" "),s("p",[n._v("Linux中ImageIO生成图片中文乱码文章的图片")]),n._v(" "),s("p",[n._v('一开始我是怀疑字体编码可能有冲突，通过System.getProperty("file.encoding")查看我本机的编码是GBK，而我服务器（centos7）上的编码是UTF-8。因此，我在生成图片时修改了系统编码，但不管用。')]),n._v(" "),s("p",[n._v("后来在不断google中看有的网友提到“字体”，因为Centos中没有中文字体，所以才造成上图中的一个个方框（一想也对，乱码的话应该是一对不规则的符号，不能是一个个方框）。")]),n._v(" "),s("p",[n._v("找到方法就去干！")]),n._v(" "),s("p",[n._v("查看服务器字体列表")]),n._v(" "),s("p",[n._v("[root@iZ2zez5rp1bmsZ share]# cd fc-list\nbash: cd: fc-list: No such file or directory\n悲哀，连字体库都没有")]),n._v(" "),s("p",[n._v("安装字体库")]),n._v(" "),s("h1",{attrs:{id:"先安装fontconfig，用fontconfig来安装字体库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#先安装fontconfig，用fontconfig来安装字体库","aria-hidden":"true"}},[n._v("#")]),n._v(" 先安装fontconfig，用fontconfig来安装字体库")]),n._v(" "),s("p",[n._v("[root@iZ2zebjvdi1bmsZ share]# yum -y install fontconfig\nLoaded plugins: fastestmirror\n...\nInstalled:\nfontconfig.x86_64 0:2.10.95-10.el7")]),n._v(" "),s("p",[n._v("Dependency Installed:\nfontpackages-filesystem.noarch 0:1.44-8.el7")]),n._v(" "),s("p",[n._v("Complete!\nfontconfig安装成功后在/usr/share目录中就会看到fonts和fontconfig两个目录（没装fontconfig之前是没有这两个目录的）")]),n._v(" "),s("p",[n._v("Linux中ImageIO生成图片中文乱码文章的图片")]),n._v(" "),s("p",[n._v("接下来就可以添加字体库了")]),n._v(" "),s("p",[n._v("添加字体\n添加字体之前需要先下载相应的字体文件，博主用的是simsun.ttf（宋体）字体库，可以直接点击下载：下载simsun.zip")]),n._v(" "),s("p",[n._v("当然也可以去windows系统下的C:/windows/fonts目录下寻找合适的字体")]),n._v(" "),s("p",[n._v("字体文件准备好后，下边就正式开发操作")]),n._v(" "),s("p",[n._v("首先在/usr/share/fonts/目录下创建目录（名称随意）")]),n._v(" "),s("p",[n._v("mkdir chinese\n然后将上方提供的")]),n._v(" "),s("p",[n._v("zip包中的两个文件全部解压并放到新建的目录（chinese）中，")]),n._v(" "),s("p",[n._v("然后修改chinese目录的权限")]),n._v(" "),s("p",[n._v("chmod -R 755 /usr/share/fonts/chinese\n接下来需要安装ttmkfdir，这个命令的作用是搜索目录中所有的字体信息，汇总生成fonts.scale文件。")]),n._v(" "),s("p",[n._v("[root@iZ2zebjvditp1bmsZ fonts]# yum -y install ttmkfdir\nLoaded plugins: fastestmirror\n...\nInstalled:\nttmkfdir.x86_64 0:3.0.9-42.el7")]),n._v(" "),s("p",[n._v("Complete!\n然后执行ttmkfdir命令：")]),n._v(" "),s("p",[n._v("[root@iZ2zz5rp1bmsZ fonts]# ttmkfdir -e /usr/share/X11/fonts/encodings/encodings.dir\n最后修改字体配置文件")]),n._v(" "),s("p",[n._v("vi /etc/fonts/fonts.conf\n如下添加配置")]),n._v(" "),s("p",[n._v("Linux中ImageIO生成图片中文乱码文章的图片")]),n._v(" "),s("dir",[n._v("/usr/share/fonts/chinese")]),n._v("\n最后保存文件并执行fc-cache进行刷新字体缓存\n"),s("p",[n._v("OK，到此字体就安装完成，在看一下字体列表：（如果 fc-list 无效时 重启下服务器系统）\n转载：https://www.zhyd.me/article/66\nroot@iZ2zebrp1bmsZ fonts]# fc-list /usr/share/fonts/chinese/simsun.ttc: SimSun-PUA,宋体-PUA:style=Regular /usr/share/fonts/chinese/simsun.ttc: NSimSun,新宋体:style=Regular /usr/share/fonts/chinese/simsun.ttf: SimSun,宋体:style=Regular /usr/share/fonts/chinese/simsun.ttc: SimSun,宋体:style=Regular")])],1)},[],!1,null,null,null);t.default=i.exports}}]);